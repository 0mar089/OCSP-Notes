Escaneo rápido (por defecto examina 1000 puertos comunes):
```
nmap <host>
```

Escaneo completo de puertos TCP + NSE scripts por defecto + versión:

```
nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn <host> -oG allPorts
```

- `-p-` : todos los puertos (1-65535)
- `--open` : puertos solo abiertos
- `-sV` : detección de versiones
- `-oA <name>` : output en varios formatos
- `--min-rate 5000`: escaneo rapido
-  `-vvv`: que la salida de informacion adicional del escaneo

Al archivo grepeable le ejecutas la funcion 22,80,110,139,143,445,31337 y se copiará en la clipboard los puertos abiertos.

Escaneo agresivo (OS + scripts):
```
nmap -sCV -p<puerto1,puerto2..> <host> -oN targeted
```
Un escaneo agresivo donde puedes identificar versiones de los puertos y mas informacion del sistema.
-  `-sCV`: aplica una serie de scripts y te da las versiones de los puertos (Perfecto para **Ban Grabber**)

### UDP Scan

Con el flag `-sU` podemos escanear puertos UDP. 

### Técnicas de evasión


- `-Pn` → evadir bloqueo ICMP → Ya que hay Firewalls que bloquean los paquetes ICMP
- `-sS` → stealth → Esto permite no efectuar el three-way-hanshake y evitar logs en el sistema
- `-sA` → analizar firewall  → Envia ACKs para ver si el Firewall es restrictivo o no
- `--source-port 53` → evadir reglas por puerto → Permite originar el trafico desde un puerto en concreto. 
- `-D RND:5` → ocultar IP real  → Genera 5 IPs falsas randoms
- `-f` → fragmentación → Para evadir Firewalls que solo leen paquetes ensamblados y no en trozos.
- `-T0/-T1` → reducir la velocidad del escaneo
- `-n` → Sin resolver nombres DNS
- `--disable-arp-ping` → Desactiva paquetes ARP que se detectan en una LAN muy facil (Requests y Reply)

## Servicios típicos
[[FTP]] 
[[HTTP & HTTPS]] 
[[SMB]]
[[SNMP]] 
[[NFS]]
[[DNS]]
[[SMTP]]
[[IMAPvsPOP3]]
[[MySQL]]
[[MSSQL]] 
[[Oracle TNS]]
[[IPMI]]
[[SSH]]
[[RDP&WinRM&WMI]]







