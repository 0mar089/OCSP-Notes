
## RDP

Protocolo que permite acceso grafico remoto a sistemas Windows

Puerto **TCP / 3389**  o **UDP / 3389** , cifrado con TLS. 

### Enumeración

```
nmap -sV -sC -p3389 --script rdp* IP
```

Permite identificar: Nombre del host, versión del producto, si NLA está habilitado y el dominio NetBIOS.


*rdp-sec-check:* Script en Perl para verificar configuraciones de cifrado y vulnerabilidades en el handshake.

```
./rdp-sec-check.pl <IP>
```

Para conectarnos al servicio, podemos usar *xfreerdp*:

```
xfreerdp3 /u:<usuario> /p:<password> /v:<IP>
```


## WinRM

Protocolo basado en comandos que utiliza SOAP para la comunicación.

Puertos **5985 / TCP** (HTTP) o **5986 / TCP** (HTTPS). 

### Enumeración

```
nmap -sV -sC -p5985,5986 --disable-arp-ping <IP>
```

*Evil-WinRM:* La herramienta estándar en Linux para obtener una shell de PowerShell sobre WinRM.

```
evil-winrm -i <IP> -u <usuario> -p <password>
```


## WMI

Interfaz crítica que permite acceso de lectura/escritura a casi todas las configuraciones del sistema.

Puerto **135 / TCP**

*wmiexec.py (Impacket):* Permite ejecutar comandos de forma semi-interactiva. Es muy útil porque es difícil de detectar y no requiere un agente instalado.

```
wmiexec.py <usuario>:'<password>'@<IP> "hostname"
```

